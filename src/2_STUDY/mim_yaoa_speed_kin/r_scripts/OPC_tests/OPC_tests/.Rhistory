ggplot(aes(x=speed_cond_num,y=~kin_measures[kini]))+
geom_point(pch=16, col ="grey")+
geom_line(aes(y=fit.m), col = 1, size = 2)
tmpt %>%
ggplot(aes(x=speed_cond_num,y=!!kin_measures[kini]))+
geom_point(pch=16, col ="grey")+
geom_line(aes(y=fit.m), col = 1, size = 2)
tmpt %>%
ggplot(aes(x=speed_cond_num,y=str_glue(kin_measures[kini])))+
geom_point(pch=16, col ="grey")+
geom_line(aes(y=fit.m), col = 1, size = 2)
tmpt %>%
ggplot(aes(x=speed_cond_num,y={{kin_measures[kini]}}))+
geom_point(pch=16, col ="grey")+
geom_line(aes(y=fit.m), col = 1, size = 2)
tmpt %>%
ggplot(aes(x=speed_cond_num,y=.data[[kin_measures[kini]]]))+
geom_point(pch=16, col ="grey")+
geom_line(aes(y=fit.m), col = 1, size = 2)
tmpt %>%
ggplot(aes(x=speed_cond_num,y=value,col=unit))+
geom_point(alpha = 0.3) +
geom_lin(aes(y=fit.c, col=unit),size=2)+
facet_wrap(vars(unit))
tmpt %>%
ggplot(aes(x=speed_cond_num,y=value,col=unit))+
geom_point(alpha = 0.3) +
geom_line(aes(y=fit.c, col=unit),size=2)+
facet_wrap(vars(unit))
tmpt %>%
ggplot(aes(x=speed_cond_num,y=value,col=subj_char))+
geom_point(alpha = 0.3) +
geom_line(aes(y=fit.c, col=subj_char),size=2)+
facet_wrap(vars(subj_char))
tmpt %>%
ggplot(aes(x=speed_cond_num,y=.data[[kin_measures[kini]]],col=subj_char))+
geom_point(alpha = 0.3) +
geom_line(aes(y=fit.c, col=subj_char),size=2)+
facet_wrap(vars(subj_char))
tmpt %>%
ggplot(aes(x = speed_cond_num, y = .data[[kin_measures[kini]]], col = subj_char)) +
geom_point(pch = 16) +
geom_line(aes(y = fit.c, col = subj_char), size = 2)
tmpt %>%
ggplot(aes(x = speed_cond_num, y = .data[[kin_measures[kini]]], col = subj_char)) +
geom_point(pch = 16) +
geom_line(aes(y = fit.c, col = subj_char), size = 1)
tmpt %>%
ggplot(aes(x = speed_cond_num, y = .data[[kin_measures[kini]]], col = subj_char)) +
geom_point(pch = 16) +
geom_line(aes(y = fit.c, col = subj_char), size = .1)
tmpt %>%
ggplot(aes(x = speed_cond_num, y = .data[[kin_measures[kini]]], col = subj_char)) +
geom_point(pch = 16, size=2) +
geom_line(aes(y = fit.c, col = subj_char), size = .1)
tmpt %>%
ggplot(aes(x = speed_cond_num, y = .data[[kin_measures[kini]]], col = subj_char)) +
geom_point(pch = 16, size=2) +
geom_line(aes(y = fit.c, col = subj_char), size = .1) +
geom_line(aes(y=fit.m), col = 1, size = 2)
View(tmpt)
tmpt %>%
ggplot(aes(x = speed_cond_num, y = .data[[kin_measures[kini]]], col = subj_char)) +
geom_point(pch = 16, size=2) +
geom_line(aes(y = fit.c, col = subj_char), size = .1) +
geom_line(aes(y = fit.m), col = 1, size = 2)
tmpt %>%
ggplot(aes(x = speed_cond_num, y = .data[[kin_measures[kini]]], col = subj_char)) +
geom_violin() +
geom_line(aes(y = fit.c, col = subj_char), size = .1) +
geom_line(aes(y = fit.m), col = 1, size = 2)
tmpt %>%
ggplot(aes(x = speed_cond_num, y = .data[[kin_measures[kini]]])) +
geom_violin() +
geom_line(aes(y = fit.c, col = subj_char), size = .1) +
geom_line(aes(y = fit.m), col = 1, size = 2)
tmpt %>%
ggplot(aes(x = speed_ord, y = .data[[kin_measures[kini]]])) +
geom_violin() +
geom_line(aes(y = fit.c, col = subj_char), size = .1) +
geom_line(aes(y = fit.m), col = 1, size = 2)
tmpt %>%
ggplot(aes(x = speed_ord, y = .data[[kin_measures[kini]]], col = group_char)) +
geom_violin() +
geom_line(aes(y = fit.c, col = subj_char), size = .1) +
geom_line(aes(y = fit.m), col = 1, size = 2)
#%% VIOLIN
tmpt %>%
ggplot(aes(x = speed_ord, y = .data[[kin_measures[kini]]], col = group_char)) +
geom_violin() +
geom_line(aes(y = fit.c, col = subj_char), size = .1) +
geom_line(aes(y = fit.m), col = 1, size = 2)+
theme(legend.position="none")
tmpt %>%
ggplot(aes(x = speed_ord, y = .data[[kin_measures[kini]]], rows = group_char)) +
geom_violin() +
geom_line(aes(y = fit.c, col = subj_char), size = .1) +
geom_line(aes(y = fit.m), col = 1, size = 2)+
theme(legend.position="none")
tmpt %>%
ggplot(aes(x = speed_ord, y = .data[[kin_measures[kini]]], group = group_char)) +
geom_violin() +
geom_line(aes(y = fit.c, col = subj_char), size = .1) +
geom_line(aes(y = fit.m), col = 1, size = 2)+
theme(legend.position="none")
tmpt %>%
ggplot(aes(x = speed_ord, y = .data[[kin_measures[kini]]], col = group_char)) +
geom_violin() +
geom_line(aes(y = fit.c, row = subj_char), size = .1) +
geom_line(aes(y = fit.m), col = 1, size = 2)+
theme(legend.position="none")
#%% VIOLIN
tmpt %>%
ggplot(aes(x = speed_ord, y = .data[[kin_measures[kini]]], col = group_char)) +
geom_violin() +
geom_line(aes(y = fit.c, row = subj_char), size = .1) +
geom_line(aes(y = fit.m), col = 1, size = 2)+
guides(fill="none");
tmpt %>%
ggplot(aes(x = speed_ord, y = .data[[kin_measures[kini]]],col=subj_char)) +
geom_violin() +
geom_line(aes(y = fit.c, col = subj_char), size = .1) +
geom_line(aes(y = fit.m), col = 1, size = 2)+
facet_wrap(vars(group_char))
tmpt %>%
ggplot(aes(x = speed_ord, y = .data[[kin_measures[kini]]],col=subj_char)) +
geom_violin() +
geom_line(aes(y = fit.c, col = subj_char), size = .1) +
geom_line(aes(y = fit.m), col = 1, size = 2)+
guides(subj_char="none")
tmpt %>%
ggplot(aes(x = speed_ord, y = .data[[kin_measures[kini]]])) +
geom_violin(position="dodge", alpha=0.5, outlier.coulour="black")+
facet_wrap(vars(group_char))
tmpt %>%
ggplot(aes(x = speed_ord, y = .data[[kin_measures[kini]]])) +
geom_violin(position="dodge", alpha=0.5, outlier.colour="black") +
geom_boxplot(width=0.1, color="grey", alpha=0.2)+
facet_wrap(vars(group_char))
tmpt %>%
ggplot(aes(x = speed_ord, y = .data[[kin_measures[kini]]])) +
geom_violin(position="dodge", alpha=0.5) +
geom_boxplot(width=0.2, color="grey", alpha=0.2)+
geom_line(aes(y=fit.m), col = 1, size = 2)+
facet_wrap(vars(group_char))
tmpt %>%
ggplot(aes(x = speed_cond_num, y = .data[[kin_measures[kini]]])) +
geom_violin(position="dodge", alpha=0.5) +
geom_boxplot(width=0.2, color="grey", alpha=0.2)+
geom_line(aes(y=fit.m), col = speed_cond_num, size = 2)+
facet_wrap(vars(group_char))
tmpt %>%
ggplot(aes(x = speed_cond_num, y = .data[[kin_measures[kini]]])) +
geom_violin(position="dodge", alpha=0.5) +
geom_boxplot(width=0.2, color="grey", alpha=0.2)+
geom_line(aes(y=fit.m), col = vars(speed_cond_num), size = 2)+
facet_wrap(vars(group_char))
tmpt %>%
ggplot(aes(x = speed_cond_num, y = .data[[kin_measures[kini]]])) +
geom_violin(position="dodge", alpha=0.5) +
geom_boxplot(width=0.2, color="grey", alpha=0.2)+
geom_line(aes(x= speed_cond_num, y=fit.m), size = 2)+
facet_wrap(vars(group_char))
tmpt %>%
ggplot(aes(x = speed_cond_num, y = .data[[kin_measures[kini]]],group=group_char)) +
geom_violin(position="dodge", alpha=0.5) +
geom_boxplot(width=0.2, color="grey", alpha=0.2)+
geom_line(aes(x= speed_cond_num, y=fit.m), size = 2)+
facet_wrap(vars(group_char))
tmpt %>%
ggplot(aes(x = factor(speed_cond_num), y = .data[[kin_measures[kini]]],group=group_char)) +
geom_violin(position="dodge", alpha=0.5) +
geom_boxplot(width=0.2, color="grey", alpha=0.2)+
geom_line(aes(x= speed_cond_num, y=fit.m), size = 2)+
facet_wrap(vars(group_char))
tmpt %>%
ggplot(aes(x = speed_ord, y = .data[[kin_measures[kini]]],group=group_char)) +
geom_violin(position="dodge", alpha=0.5) +
geom_boxplot(width=0.2, color="grey", alpha=0.2)+
geom_line(aes(x= speed_cond_num, y=fit.m), size = 2)+
facet_wrap(vars(group_char))
tmpt %>%
ggplot(aes(x = speed_ord, y = .data[[kin_measures[kini]]],group=group_char)) +
geom_violin(position="dodge", alpha=0.5) +
geom_boxplot(width=0.2, color="grey", alpha=0.2)+
geom_line(aes(x= speed_ord, y=fit.m), size = 2)+
facet_wrap(vars(group_char))
tmpt %>%
ggplot(aes(x = speed_ord, y = .data[[kin_measures[kini]]],group=group_char)) +
geom_violin(position="dodge", alpha=0.5) +
geom_boxplot(width=0.2, color="grey", alpha=0.2)+
geom_line(aes(x= speed_ord, y=fit.m), col=group_char, size = 2)+
facet_wrap(vars(group_char))
tmpt %>%
ggplot(aes(x = speed_ord, y = .data[[kin_measures[kini]]],group=group_char)) +
geom_violin(position="dodge", alpha=0.5) +
geom_boxplot(width=0.2, color="grey", alpha=0.2)+
geom_line(aes(x= speed_ord, y=fit.m), col=vars(group_char), size = 2)+
facet_wrap(vars(group_char))
tmpt %>%
ggplot(aes(x = speed_ord, y = .data[[kin_measures[kini]]],group=group_char)) +
geom_violin(position="dodge", alpha=0.5) +
geom_boxplot(width=0.2, color="grey", alpha=0.2)+
geom_line(aes(x= speed_ord, y=fit.m, col=group_char), size = 2)+
facet_wrap(vars(group_char))
tmpt %>%
ggplot(aes(x = speed_ord, y = .data[[kin_measures[kini]]],group=group_char)) +
geom_violin(position="dodge", alpha=0.5) +
geom_boxplot(width=0.2, color="grey", alpha=0.2)+
geom_line(aes(x= speed_cond_num, y=fit.m, col=group_char), size = 2)+
facet_wrap(vars(group_char))
tmpt %>%
ggplot(aes(x = speed_cond_num, y = .data[[kin_measures[kini]]],group=group_char)) +
geom_violin(position="dodge", alpha=0.5) +
geom_boxplot(width=0.2, color="grey", alpha=0.2)+
geom_line(aes(x= speed_cond_num, y=fit.m, col=group_char), size = 2)+
facet_wrap(vars(group_char))
tmpt %>%
ggplot(aes(x = speed_cond_num, y = .data[[kin_measures[kini]]],group=group_char)) +
geom_point(pch=16, size=2, alpha=0.5) +
geom_boxplot(width=0.2, color="grey", alpha=0.2)+
geom_line(aes(x= speed_cond_num, y=fit.m, col=group_char), size = 2)+
facet_wrap(vars(group_char))
tmpt %>%
ggplot(aes(x = speed_cond_num, y = .data[[kin_measures[kini]]],group=group_char)) +
geom_point(pch=16, size=2, alpha=0.5) +
geom_boxplot(width=0.2, color="grey", alpha=0.2)+
geom_line(aes(x= speed_cond_num, y = fit.c, col = subj_char), size = .1) +
geom_line(aes(x= speed_cond_num, y=fit.m, col=group_char), size = 2)+
facet_wrap(vars(group_char))
tmpt %>%
ggplot(aes(x = speed_cond_num, y = .data[[kin_measures[kini]]],group=group_char)) +
geom_point(pch=16, size=2, alpha=0.5) +
geom_line(aes(x= speed_cond_num, y=fit.c, col = subj_char), size = .1) +
geom_line(aes(x= speed_cond_num, y=fit.m, col=group_char), size = 2)+
facet_wrap(vars(group_char))+
guides(subj_char="none")
tmpt %>%
ggplot(aes(x = speed_cond_num, y = .data[[kin_measures[kini]]], col = subj_char, group=group_char)) +
geom_point(pch=16, size=2, alpha=0.5) +
geom_line(aes(x= speed_cond_num, y=fit.c, col = subj_char), size = .1) +
geom_line(aes(x= speed_cond_num, y=fit.m, col = group_char), size = 2)+
facet_wrap(vars(group_char))+
guides(subj_char="none")
tmpt %>%
ggplot(aes(x = speed_cond_num, y = .data[[kin_measures[kini]]], col = subj_char, group=group_char)) +
geom_point(pch=16, size=2, alpha=0.5) +
geom_line(aes(x= speed_cond_num, y=fit.c, col = subj_char), size = .1) +
geom_line(aes(x= speed_cond_num, y=fit.m, col = group_char), size = 2)+
facet_wrap(vars(group_char))+
guides(col="none")
tmpt %>%
ggplot(aes(x = speed_cond_num, y = .data[[kin_measures[kini]]], col = subj_char, group=group_char)) +
geom_point(pch=16, size=2, alpha=0.5) +
geom_line(aes(x= speed_cond_num, y=fit.c, group = subj_char), size = .1) +
geom_line(aes(x= speed_cond_num, y=fit.m, col = group_char), size = 2)+
facet_wrap(vars(group_char))+
guides(col="none")
tmpt %>%
ggplot(aes(x = speed_cond_num, y = .data[[kin_measures[kini]]], col = subj_char, group=group_char)) +
geom_point(pch=16, size=2, alpha=0.5) +
geom_line(aes(x= speed_cond_num, y=fit.c, group = subj_char), size = .1) +
geom_line(aes(x= speed_cond_num, y=fit.m, col = group_char), size = 2)+
facet_wrap(vars(group_char))+
guides(group="none")
tmpt %>%
ggplot(aes(x = speed_cond_num, y = .data[[kin_measures[kini]]], col = subj_char, group=group_char)) +
geom_point(pch=16, size=2, alpha=0.5) +
geom_line(aes(x= speed_cond_num, y=fit.c, group = subj_char),color="grey", size = .1) +
geom_line(aes(x= speed_cond_num, y=fit.m, col = group_char), size = 2)+
facet_wrap(vars(group_char))+
guides(col="none")
for(modi in 1:length(fitfit)){
kini = kin_inds_plot[modi]
tmpt <- tmpt %>%
mutate(fit.m = predict(fitfit$mod[[modi]], re.form = NA),
fit.c = predict(fitfit$mod[[modi]], re.form = NULL))
cat(kin_measures[kini])
print(
tmpt %>%
ggplot(aes(x = speed_cond_num, y = .data[[kin_measures[kini]]], col = subj_char, group=group_char)) +
geom_point(pch=16, size=2, alpha=0.5) +
geom_line(aes(x= speed_cond_num, y=fit.c, group = subj_char),color="grey", size = .1) +
geom_line(aes(x= speed_cond_num, y=fit.m, col = group_char), size = 2)+
facet_wrap(vars(group_char))+
guides(col="none")
)
}
length(fitfit)
kin_measures[kin_inds_plot]
tmpt %>%
ggplot(aes(x = speed_cond_num, y = .data[[kin_measures[kini]]], col = subj_char, group=group_char)) +
geom_point(pch=16, size=2, alpha=0.5) +
geom_line(aes(x= speed_cond_num, y=fit.c, row = subj_char),color="grey", size = .1) +
geom_line(aes(x= speed_cond_num, y=fit.m, col = group_char), size = 2)+
facet_wrap(vars(group_char))+
ggtitle(kin_measures[kini])+
guides(col="none")
print(
tmpt %>%
ggplot(aes(x = speed_cond_num, y = .data[[kin_measures[kini]]], col = subj_char, group=group_char)) +
geom_point(pch=16, size=2, alpha=0.5) +
geom_line(aes(x= speed_cond_num, y=fit.c, col = subj_char),color="grey", size = .1) +
geom_line(aes(x= speed_cond_num, y=fit.m, group = group_char), size = 2)+
facet_wrap(vars(group_char))+
ggtitle(kin_measures[kini])+
guides(col="none")
)
tmpt %>%
ggplot(aes(x = speed_cond_num, y = .data[[kin_measures[kini]]], group = subj_char, col=group_char)) +
geom_point(pch=16, size=2, alpha=0.5) +
geom_line(aes(x= speed_cond_num, y=fit.c, group = subj_char),color="grey", size = .1) +
geom_line(aes(x= speed_cond_num, y=fit.m, col = group_char), size = 2)+
facet_wrap(vars(group_char))+
ggtitle(kin_measures[kini])+
guides(col="none")
tmpt %>%
ggplot(aes(x = speed_cond_num, y = .data[[kin_measures[kini]]], group = subj_char, col=group_char)) +
geom_point(pch=16, size=2, alpha=0.5) +
geom_line(aes(x= speed_cond_num, y=fit.c, group = subj_char),color="grey", size = .1) +
geom_line(aes(x= speed_cond_num, y=fit.m, col = group_char), size = 2)+
facet_wrap(vars(group_char))+
ggtitle(kin_measures[kini])+
guides(group="none")
library(gtsummary)
for (ci in 1:(length(clusters))) {
tmpt <- filter_at(eegt,vars('cluster_id'), any_vars(. %in% clusters[ci]));
for (mi in 1:length(kin_measures)) {
tbl <- tibble(outcome=eeg_measures[eeg_inds_plot]) %>%
rowwise() %>%
mutate(
tbl =
lmer(str_glue(paste("{outcome} ~ 1 + ",kin_measures[mi]," + group_char + ",kin_measures[mi],":group_char + (1|subj_char)")), data=tmpt) %>%
tbl_regression(tidy_fun = broom.mixed::tidy,
pvalue_fun = purrr::partial(style_pvalue, digits = 2),
intercept=TRUE) %>%
add_global_p() %>%
add_q() %>%
list()
) %>%
pull(tbl) %>%
tbl_merge(tab_spanner=eeg_title_chars[eeg_inds_plot])
t_out <- as_gt(tbl) %>%
gt::tab_header(title=c("Changes in ",eeg_measures[mi],"for Cluster: ",clusters[ci])) %>%
gt::tab_options(table.layout = "fixed") %>%
gt::as_raw_html()
print(t_out)
rsq <- tibble(outcome=eeg_measures[eeg_inds_plot]) %>%
rowwise() %>%
mutate(
mod =
lmer(str_glue(paste("{outcome} ~ 1 + ",kin_measures[mi]," + group_char + ",kin_measures[mi],":group_char + (1|subj_char)")), data=tmpt) %>%
r.squaredGLMM(),
print(str_glue("{outcome}\n R2m: {round(mod[1],4)},\tR2c: {round(mod[2],4)}\n\n"))
)
#%% VISUALIZATION OF MODELS
theme_set(theme_classic()) # This sets the default ggplot theme
fitfit <- tibble(outcome=eeg_measures[eeg_inds_plot]) %>%
rowwise() %>%
mutate(
mod =
lmer(str_glue(paste("{outcome} ~ 1 + ",kin_measures[mi]," + group_char + ",kin_measures[mi],":group_char + (1|subj_char)")), data=tmpt)%>%
list()
)
for(modi in 1:length(eeg_measures[eeg_inds_plot])){
eegi = eeg_inds_plot[modi]
tmpt <- tmpt %>%
mutate(fit.m = predict(fitfit$mod[[modi]], re.form = NA),
fit.c = predict(fitfit$mod[[modi]], re.form = NULL))
print(
tmpt %>%
ggplot(aes(x = data[[kin_measures[mi]]], y = .data[[eeg_measures[eegi]]], group = subj_char, col=group_char)) +
geom_point(pch=16, size=2, alpha=0.5) +
geom_line(aes(x= data[[kin_measures[mi]]], y=fit.c, group = subj_char),color="grey", size = .1) +
geom_line(aes(x= data[[kin_measures[mi]]], y=fit.m, col = group_char), size = 2)+
facet_wrap(vars(group_char))+
ggtitle(eeg_measures[eegi])+
guides(group="none")
)
}
# t_out <- as_kable_extra(tbl, format = "latex") %>%
#   add_header_above(c("Changes in ",kin_measures[mi],"for Cluster: ",clusters[ci])) %>%
#   kable_styling(latex_options="scale_down")
# cat(knitr::knit_print(t_out));
# if (mi%%2 == 0){
#   cat('\\clearpage');
# }
}
}
library(gtsummary)
for (ci in 1:(length(clusters))) {
tmpt <- filter_at(eegt,vars('cluster_id'), any_vars(. %in% clusters[ci]));
for (mi in 1:length(kin_measures)) {
tbl <- tibble(outcome=eeg_measures[eeg_inds_plot]) %>%
rowwise() %>%
mutate(
tbl =
lmer(str_glue(paste("{outcome} ~ 1 + ",kin_measures[mi]," + group_char + ",kin_measures[mi],":group_char + (1|subj_char)")), data=tmpt) %>%
tbl_regression(tidy_fun = broom.mixed::tidy,
pvalue_fun = purrr::partial(style_pvalue, digits = 2),
intercept=TRUE) %>%
add_global_p() %>%
add_q() %>%
list()
) %>%
pull(tbl) %>%
tbl_merge(tab_spanner=eeg_title_chars[eeg_inds_plot])
t_out <- as_gt(tbl) %>%
gt::tab_header(title=c("Changes in ",eeg_measures[mi],"for Cluster: ",clusters[ci])) %>%
gt::tab_options(table.layout = "fixed") %>%
gt::as_raw_html()
print(t_out)
rsq <- tibble(outcome=eeg_measures[eeg_inds_plot]) %>%
rowwise() %>%
mutate(
mod =
lmer(str_glue(paste("{outcome} ~ 1 + ",kin_measures[mi]," + group_char + ",kin_measures[mi],":group_char + (1|subj_char)")), data=tmpt) %>%
r.squaredGLMM(),
print(str_glue("{outcome}\n R2m: {round(mod[1],4)},\tR2c: {round(mod[2],4)}\n\n"))
)
#%% VISUALIZATION OF MODELS
theme_set(theme_classic()) # This sets the default ggplot theme
fitfit <- tibble(outcome=eeg_measures[eeg_inds_plot]) %>%
rowwise() %>%
mutate(
mod =
lmer(str_glue(paste("{outcome} ~ 1 + ",kin_measures[mi]," + group_char + ",kin_measures[mi],":group_char + (1|subj_char)")), data=tmpt)%>%
list()
)
for(modi in 1:length(eeg_measures[eeg_inds_plot])){
eegi = eeg_inds_plot[modi]
tmpt <- tmpt %>%
mutate(fit.m = predict(fitfit$mod[[modi]], re.form = NA),
fit.c = predict(fitfit$mod[[modi]], re.form = NULL))
print(
tmpt %>%
ggplot(aes(x = data[[kin_measures[mi]]], y = .data[[eeg_measures[eegi]]], group = subj_char, col=group_char)) +
geom_point(pch=16, size=2, alpha=0.5) +
geom_line(aes(x= data[[kin_measures[mi]]], y=fit.c, group = subj_char),color="grey", size = .1) +
geom_line(aes(x= data[[kin_measures[mi]]], y=fit.m, col = group_char), size = 2)+
facet_wrap(vars(group_char))+
ggtitle(eeg_measures[eegi])+
guides(group="none")
)
}
# t_out <- as_kable_extra(tbl, format = "latex") %>%
#   add_header_above(c("Changes in ",kin_measures[mi],"for Cluster: ",clusters[ci])) %>%
#   kable_styling(latex_options="scale_down")
# cat(knitr::knit_print(t_out));
# if (mi%%2 == 0){
#   cat('\\clearpage');
# }
}
}
tmpt <- filter_at(eegt,vars('cluster_id'), any_vars(. %in% clusters[ci]));
theme_set(theme_classic()) # This sets the default ggplot theme
fitfit <- tibble(outcome=eeg_measures[eeg_inds_plot]) %>%
rowwise() %>%
mutate(
mod =
lmer(str_glue(paste("{outcome} ~ 1 + ",kin_measures[mi]," + group_char + ",kin_measures[mi],":group_char + (1|subj_char)")), data=tmpt)%>%
list()
)
for(modi in 1:length(eeg_measures[eeg_inds_plot])){
eegi = eeg_inds_plot[modi]
tmpt <- tmpt %>%
mutate(fit.m = predict(fitfit$mod[[modi]], re.form = NA, na.action=na.exclude),
fit.c = predict(fitfit$mod[[modi]], re.form = NULL, na.action=na.exclude))
print(
tmpt %>%
ggplot(aes(x = data[[kin_measures[mi]]], y = .data[[eeg_measures[eegi]]], group = subj_char, col=group_char)) +
geom_point(pch=16, size=2, alpha=0.5) +
geom_line(aes(x= data[[kin_measures[mi]]], y=fit.c, group = subj_char),color="grey", size = .1) +
geom_line(aes(x= data[[kin_measures[mi]]], y=fit.m, col = group_char), size = 2)+
facet_wrap(vars(group_char))+
ggtitle(eeg_measures[eegi])+
guides(group="none")
)
}
tmpt <- filter_at(eegt,vars('cluster_id'), any_vars(. %in% clusters[ci]));
for(ki in 1:length(kin_measures[kin_inds_plot])){
tmpt = tmpt[complete.cases(tmpt[[kin_measures[ki]]]),]
}
fitfit <- tibble(outcome=eeg_measures[eeg_inds_plot]) %>%
rowwise() %>%
mutate(
mod =
lmer(str_glue(paste("{outcome} ~ 1 + ",kin_measures[mi]," + group_char + ",kin_measures[mi],":group_char + (1|subj_char)")), data=tmpt)%>%
list()
)
modi = 1;
eegi = eeg_inds_plot[modi]
tmpt <- tmpt %>%
mutate(fit.m = predict(fitfit$mod[[modi]], re.form = NA),
fit.c = predict(fitfit$mod[[modi]], re.form = NULL))
tmpt %>%
ggplot(aes(x = data[[kin_measures[mi]]], y = .data[[eeg_measures[eegi]]], group = subj_char, col=group_char)) +
geom_point(pch=16, size=2, alpha=0.5) +
geom_line(aes(x= data[[kin_measures[mi]]], y=fit.c, group = subj_char),color="grey", size = .1) +
geom_line(aes(x= data[[kin_measures[mi]]], y=fit.m, col = group_char), size = 2)+
facet_wrap(vars(group_char))+
ggtitle(eeg_measures[eegi])+
guides(group="none")
tmpt %>%
ggplot(aes(x = .data[[kin_measures[mi]]], y = .data[[eeg_measures[eegi]]], group = subj_char, col=group_char)) +
geom_point(pch=16, size=2, alpha=0.5) +
geom_line(aes(x= .data[[kin_measures[mi]]], y=fit.c, group = subj_char),color="grey", size = .1) +
geom_line(aes(x= .data[[kin_measures[mi]]], y=fit.m, col = group_char), size = 2)+
facet_wrap(vars(group_char))+
ggtitle(eeg_measures[eegi])+
guides(group="none")
eegi
